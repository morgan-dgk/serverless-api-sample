<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Global</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Global</h1>

    




<section>

<header>
    
        <h2></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

        


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


        
    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="LambdaHandler"><span class="type-signature">(constant) </span>LambdaHandler<span class="type-signature"></span></h4>




<div class="description">
    Handler for client file download. 

The client's bucket name and temporary credentials for access to the bucket are provided by the auth response from
the lambda authorizer and are accessible on `requestContext.authorizer.lambda.credentials`. The file name
should be passed as a path parameter, e.g. files/{url-encoded-file-name-here}.

The getSignedUrl function does not throw an error when attempting to generate a URL for a non-existant object.
For this reason, it is necessary to first check if an object exists with `GetObjectAttributesCommand`.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="handlers_presigned-get.mjs.html">handlers/presigned-get.mjs</a>, <a href="handlers_presigned-get.mjs.html#line25">line 25</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="LambdaHandler"><span class="type-signature">(constant) </span>LambdaHandler<span class="type-signature"></span></h4>




<div class="description">
    Handler for client file upload. 

The client's bucket name and temporary credentials for access to the bucket are provided by the auth response from
the lambda authorizer and are accessible on `requestContext.authorizer.lambda.credentials`. The file name
should be passed as a path parameter, e.g. files/{url-encoded-file-name-here}.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="handlers_presigned-post.mjs.html">handlers/presigned-post.mjs</a>, <a href="handlers_presigned-post.mjs.html#line18">line 18</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="assumeUserRole"><span class="type-signature">(async) </span>assumeUserRole<span class="signature">(client_uuid, sub)</span><span class="type-signature"> &rarr; {object}</span></h4>
    

    



<div class="description">
    Retrieves temporary access credentials from Amazon's Secure Token Service (sts).
These credentials provided scoped access to the client's S3 bucket only; access is limited
by the policy document returned by `getPolicyForTenantUser`.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>client_uuid</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">the unique identifier for the client the user belongs to.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sub</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">the subject / userid as provided in the JWT. This value is provided by the cognito user pool.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="authorizer_custom_auth.mjs.html">authorizer/custom_auth.mjs</a>, <a href="authorizer_custom_auth.mjs.html#line68">line 68</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Credentials - contains the temporary credentials retrieved from sts.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="authorize"><span class="type-signature"></span>authorize<span class="signature">(event)</span><span class="type-signature"> &rarr; {object}</span></h4>
    

    



<div class="description">
    Main lambda authorizer function.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>event</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last">an AWS lambda event, see https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-event</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="authorizer_custom_auth.mjs.html">authorizer/custom_auth.mjs</a>, <a href="authorizer_custom_auth.mjs.html#line127">line 127</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    auth_response - auth'z response in the required output format, see https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-lambda-authorizer-output.html
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getClaims"><span class="type-signature">(async) </span>getClaims<span class="signature">(token)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Verifies the signature and audience of JWT and returns the decoded claims. Does most of the work of validating user authorization.
If either of these values are incorrect, this function will throw an error.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>token</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">a JWT</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="authorizer_custom_auth.mjs.html">authorizer/custom_auth.mjs</a>, <a href="authorizer_custom_auth.mjs.html#line116">line 116</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="getPolicyForTenantUser"><span class="type-signature"></span>getPolicyForTenantUser<span class="signature">(client_uuid)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Returns a policy document with scoped access based on the client_uuid
passed in JWT to lambda authorizer.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>client_uuid</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">the unique identifier for the client the user belongs to.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="authorizer_custom_auth.mjs.html">authorizer/custom_auth.mjs</a>, <a href="authorizer_custom_auth.mjs.html#line30">line 30</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="getScopedS3Client"><span class="type-signature"></span>getScopedS3Client<span class="signature">(temp_access_credentials)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Creates an S3 client based on the previously retrieved
scoped temporary access credentials.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>temp_access_credentials</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">a set of temporary access credentials retrieved from AWS sts.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>accessKeyId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>SecretAccessKey</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>SessionToken</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layers_helpers_helpers.mjs.html">layers/helpers/helpers.mjs</a>, <a href="layers_helpers_helpers.mjs.html#line13">line 13</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="parseTokenData"><span class="type-signature"></span>parseTokenData<span class="signature">(event)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Extracts JWT from Authorization header of incoming requests. Note that the lambda authorizer
  will reject any incoming requests missing the Authorization header with a 401 error.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>event</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last">an AWS lambda event, see https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-event</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="authorizer_custom_auth.mjs.html">authorizer/custom_auth.mjs</a>, <a href="authorizer_custom_auth.mjs.html#line87">line 87</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#LambdaHandler">LambdaHandler</a></li><li><a href="global.html#assumeUserRole">assumeUserRole</a></li><li><a href="global.html#authorize">authorize</a></li><li><a href="global.html#getClaims">getClaims</a></li><li><a href="global.html#getPolicyForTenantUser">getPolicyForTenantUser</a></li><li><a href="global.html#getScopedS3Client">getScopedS3Client</a></li><li><a href="global.html#parseTokenData">parseTokenData</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Tue May 07 2024 13:10:16 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>